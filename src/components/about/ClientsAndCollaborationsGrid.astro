---
type ImageModule = string;

const clientImports = import.meta.glob<ImageModule>("../../assets/images/clients/*.svg");
const clients: ImageModule[] = await Promise.all(Object.values(clientImports).map(async (importer) => (await importer()).default));

const collabImports = import.meta.glob<ImageModule>("../../assets/images/collaborations/*.svg");
const collaborations: ImageModule[] = await Promise.all(Object.values(collabImports).map(async (importer) => (await importer()).default));
---

<section class="container relative z-2 py-16 md:py-20 lg:py-24">
  
  <!-- Clients Section -->
  <div class="relative w-full overflow-hidden py-12 md:py-16 lg:py-20">
    <h3 class="mb-8 text-center text-3xl font-bold">Our Clients</h3>

    <!-- Scrolling wrapper -->
    <div class="relative overflow-hidden scrolling">
      <div class="flex animate-scroll whitespace-nowrap will-change-transform">
        {
          [...clients, ...clients].map((client) => (  // Duplicate in one continuous track
            <div class="flex items-center justify-center px-4 min-w-[120px] md:min-w-[160px] lg:min-w-[180px] shrink-0">
              <img
                src={client.src}
                alt={client.src.split('/').pop().split('.')[0]}
                class="h-20 md:h-12 lg:h-20 w-auto object-contain"
              />
            </div>
          ))
        }
      </div>
    </div>
  </div>

  <!-- Collaborations Section -->
  <div class="relative w-full overflow-hidden py-12 md:py-16 lg:py-20">
    <h3 class="mb-8 text-center text-3xl font-bold">Our Collaborations</h3>
    <div class="flex flex-wrap justify-center">
      {
        collaborations.map((collab: ImageModule) => (
          <div class="flex items-center justify-center p-4 mx-4 collab-logo">
            <img
              src={collab.src}
              alt={collab.src.split('/').pop().split('.')[0]}
              class="w-[200px] h-auto object-contain"
            />
          </div>
        ))
      }
    </div>
  </div>

  <style>
    @keyframes scroll {
      from {
        transform: translateX(0);
      }
      to {
        transform: translateX(-50%);
      }
    }

    .animate-scroll {
      display: flex;
      animation: scroll 30s linear infinite;
    }

    /* Hovering pauses the entire scroll */
    .scrolling:hover .animate-scroll {
      animation-play-state: paused;
    }

    /* Make it faster on smaller devices */
    @media (max-width: 768px) {
      .animate-scroll {
        animation-duration: 15s;
      }
    }

    /* Optional: smooth fade mask on edges */
    .scrolling::before,
    .scrolling::after {
      content: "";
      position: absolute;
      top: 0;
      width: 80px;
      height: 100%;
      z-index: 2;
      pointer-events: none;
    }

    .scrolling::before {
      left: 0;
      background: linear-gradient(to right, white, transparent);
    }

    .scrolling::after {
      right: 0;
      background: linear-gradient(to left, white, transparent);
    }
  </style>
</section>
