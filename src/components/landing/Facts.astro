<section id="facts-section" class="bg-slate-100">
	<div class="mx-auto px-8 py-16 md:px-12 lg:py-24 2xl:max-w-7xl">
		<div class="rounded-4xl bg-stone-900 p-8 shadow-xl lg:rounded-5xl lg:p-16">
			<ol role="list" class="grid list-none grid-cols-2 gap-12 text-center lg:grid-cols-4">
				<li>
					<h3 class="flex justify-center font-display text-4xl font-bold tracking-tight text-white lg:text-6xl">
						<span class="counter" data-target="10">0</span>+
					</h3>
					<p class="mt-3 text-xs font-bold uppercase tracking-[0.2em] text-stone-400">Happy Clients</p>
				</li>
				<li>
					<h3 class="flex justify-center font-display text-4xl font-bold tracking-tight text-white lg:text-6xl">
						<span class="counter" data-target="15">0</span>+
					</h3>
					<p class="mt-3 text-xs font-bold uppercase tracking-[0.2em] text-stone-400">Websites</p>
				</li>
				<li>
					<h3 class="flex justify-center font-display text-4xl font-bold tracking-tight text-white lg:text-6xl">
						<span class="counter" data-target="20">0</span>+
					</h3>
					<p class="mt-3 text-xs font-bold uppercase tracking-[0.2em] text-stone-400">Brands</p>
				</li>
				<li>
					<h3 class="flex justify-center font-display text-4xl font-bold tracking-tight text-white lg:text-6xl">
						<span class="counter" data-target="90">0</span>+
					</h3>
					<p class="mt-3 text-xs font-bold uppercase tracking-[0.2em] text-stone-400">Projects</p>
				</li>
			</ol>
		</div>
	</div>
</section>

<script>
	import { gsap } from "gsap";
	import { ScrollTrigger } from "gsap/ScrollTrigger";

	gsap.registerPlugin(ScrollTrigger);

	function initCounters() {
		const counters = document.querySelectorAll(".counter");
		if (counters.length === 0) return;

		counters.forEach((counter) => {
			const target = parseInt(counter.getAttribute("data-target") || "0");

			gsap.to(counter, {
				innerText: target,
				duration: 2,
				snap: { innerText: 1 },
				scrollTrigger: {
					trigger: "#facts-section",
					start: "top 80%",
					toggleActions: "play none none none",
				},
				ease: "power2.out",
			});
		});
	}

	// Multiple initialization points for reliability
	if (document.readyState === "loading") {
		document.addEventListener("DOMContentLoaded", initCounters);
	} else {
		initCounters();
	}

	window.addEventListener("load", initCounters);
	document.addEventListener("astro:after-swap", initCounters);
</script>
